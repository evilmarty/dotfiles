#!/bin/bash

main() {
  local lines=()

  if [ -t 0 ]; then
    >&2 echo "You need to pipe data to this script."
    return 1
  fi

  while IFS='' read -r line; do
    lines+=("$line")
  done </dev/stdin

  while true; do
    local i=1
    for line in "${lines[@]}"; do
      >/dev/tty echo "${i}) ${line}"
      ((i+=1))
    done

    >&/dev/tty read -p "Select between 0..${#lines[@]}: " choice </dev/tty
    case "$choice" in
      ''|*[!0-9]*)
        >&/dev/tty echo "Invalid selection"
        ;;
      0)
        return 1
        ;;
      *)
        echo "${lines[((choice-1))]}"
        return 0
        ;;
    esac
  done
}

main "$@"
